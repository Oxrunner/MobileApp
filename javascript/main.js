function historyPop(e){null==e.state||(e.state.mainPage&&e.state.mainPage===!0?loadChosenPage(e.state.pageName):e.state.mainPage&&e.state.mainPage===!1)}function setActivePage(){var e=window.location.href,t=e.split("#");loadChosenPage(t[1])}function mainNavigation(e){if("navIcon"==e.target.id)var t=e.target.parentNode.href;else var t=e.target.href;var n=t.split("#");setHistory(!0),loadChosenPage(n[1])}function loadChosenPage(e){-1==mainPagesInApp.indexOf(e)&&(e=mainPagesInApp[0]);for(var t=0;t<mainPagesInApp.length;t++){var n=document.getElementById(mainPagesInApp[t]);n.classList.add("inactive")}resetPages(e);var n=document.getElementById(e);n.classList.remove("inactive")}function resetPages(e){"quizPage"==e?resetQuiz(1):"informationPage"==e&&resetInformationPage()}function setHistory(e){var t=window.location.href,n=t.split("#");history.pushState({mainPage:e,pageName:n[1],subPage:""},"Space app "+n[1]+" page")}function initMap(e){map=new google.maps.Map(document.getElementById("backgroundMap"),{center:{lat:e.coords.latitude,lng:e.coords.longitude},zoom:15,mapTypeId:google.maps.MapTypeId.HYBRID,disableDefaultUI:!0})}function getUsersLocation(){navigator.geolocation?(document.getElementById("mapCover").style.opacity="0.4",document.getElementById("homePageContent").style.display="none",options={enableHighAccuracy:!1},navigator.geolocation.watchPosition(initMap,mapError,options)):x.innerHTML="Geolocation is not supported by this browser."}function mapError(){console.log("Unable to get location")}function resetInformationPage(){activatePage("page-home")}function planetLinkClick(e){e.preventDefault();var t=findParentNode("A",e.srcElement).href,n=t.split("#");setInformationPage(n[1]),setSelectedPlanet(n[1]),activatePage("planet-info");var a=document.getElementById("page-home");a.classList.add("historic")}function makeRequest(e,t,n){if(null==localStorage.getItem(n)||""==localStorage.getItem(n)||"null"==localStorage.getItem(n)){var a=new XMLHttpRequest;a.open("get","MobileAppAPI/"+e),a.onreadystatechange=function(){4===a.readyState&&(200===a.status?(localStorage.setItem(n,a.responseText),window[t](a.responseText)):console.log("Failed"))},a.send(null)}else window[t](localStorage.getItem(n))}function setInformationPage(e){for(var t={},n=JSON.parse(localStorage.getItem("planetsInfo")),a=0;a<n.length;a++)n[a].idText==e&&(t=n[a]);document.getElementById("selectedPlanet").innerHTML=t.title,document.getElementById("imageForPlanetInformation").src=t.image;var i=document.getElementById("planetInfo");i.innerHTML=t.information}function loadPlanetList(){makeRequest("PlanetInfo.txt","renderPlanetsList","planetsInfo")}function renderPlanetsList(e){var t=JSON.parse(e),n=document.getElementById("planet-list-template-iPhone").innerHTML,a="",o=document.getElementById("planet-list-template-iPad").innerHTML,s="",r=document.getElementById("planet-info-ipad-template").innerHTML,l="";for(i=0;i<t.length;i++)a+=renderTemplate(n,t[i]),s+=renderTemplate(o,t[i]),l+=renderTemplate(r,t[i]);document.getElementById("planetsList").innerHTML=a,document.getElementById("planetsList-iPad").innerHTML=s,document.getElementById("planetInfoHolder").innerHTML=l,setSelectedPlanet("sun"),setUpListeners()}function gestureChange(e){var t=findRealTarget(e.target,"informationPlanetImage");t!==!1&&(t.style.webkitTransform="rotate("+e.rotation+"deg)",2!=t.style.zIndex&&(t.style.zIndex=2),e.preventDefault())}function setSelectedPlanet(e){for(var t=document.getElementById("planetInfoHolder"),n=t.getElementsByTagName("div"),a=0;a<n.length;a++)n[a].classList.remove("selectedPlanetInfo");var i=document.getElementById(e+"-iPad");i.classList.add("selectedPlanetInfo")}function renderTemplate(e,t){var n,a,i;for(n in t)t.hasOwnProperty(n)&&(a=t[n],i=new RegExp("{\\*"+n+"\\*}","gi"),e=e.replace(i,a));return e}function backButtonClick(e){e.preventDefault(),activatePage("page-home")}function activatePage(e){deactivatePages(),window.scrollTo(0,0);var t=document.getElementById(e);t.classList.add("active"),t.classList.remove("historic")}function deactivatePages(){for(var e=0;e<pages.length;e++)pages[e].classList.remove("active")}function findParentNode(e,t){for(var n=t.parentNode,a=1;n.nodeName!=e;)n=n.parentNode,a++;return n}function setUpListeners(){planetLinks=document.querySelectorAll(".planet-link"),backButton=document.querySelector("header a"),pages=document.querySelectorAll(".page");for(var e=0;e<planetLinks.length;e++)planetLinks[e].addEventListener("click",planetLinkClick,!1);for(var t=document.getElementsByClassName("informationPlanetImage"),e=0;e<t.length;e++)t[e].addEventListener("gesturechange",gestureChange,!1);backButton.addEventListener("click",backButtonClick,!1)}function setQuestions(e){questionsInfo=JSON.parse(e);var t=window.matchMedia("(min-width: 700px)"),n=0;n=t.matches?loadiPadQuestionView(questionsInfo):loadiPhoneQuestionView(questionsInfo),createSubmitButton(n),setUpSwipe(1,n,"question"),setUpQuiz()}function loadiPhoneQuestionView(e){var t=document.getElementById("question-template").innerHTML,n="";for(i=0;i<e.length;i++)n+=renderTemplate(t,e[i]);return n+=resultsPage(),document.getElementById("questionHere").innerHTML=n,e.length}function loadiPadQuestionView(e){var t=document.getElementById("question-template-iPad").innerHTML,n=1,a='<div class="questionHere question" id="question'+n+'">';for(i=0;i<e.length;i++){a+=renderTemplate(t,e[i]);var o=(i+1)/5%1;0===o&&i+1!=e.length&&(n++,a+='</div><div class="questionHere question" id="question'+n+'">')}return a+="</div>",a+=resultsPage(),document.getElementById("questionHere").innerHTML=a,n}function setUpQuiz(){for(var e=0;e<questionsInfo.length;e++)score[e]=0;createEventListenerForAnswerInputs()}function createEventListenerForAnswerInputs(){for(var e=document.getElementsByClassName("answer"),t=0;t<e.length;t++)e[t].addEventListener("focusout",checkAnswer,!1)}function createSubmitButton(e){if(window.matchMedia("(min-width: 700px)").matches){var t="<input type='submit'name='submit' id='submitQuiz' value='Submit Quiz'/>";document.getElementById("questionNumber"+questionsInfo.length).innerHTML+=t}else{var t="<div id='SubmitQuizDiv'><input type='submit'name='submit' id='submitQuiz' value='Submit Quiz'/></div>";document.getElementById("question"+e).innerHTML+=t}document.getElementById("submitQuiz").addEventListener("click",submitQuiz)}function submitQuiz(){for(var e=0,t=0;t<score.length;t++)e+=score[t];document.getElementById("resultsName").value=localStorage.getItem("name"),document.getElementById("resultsEmail").value=localStorage.getItem("email"),document.getElementById("pageLocation").classList.add("hiddenPageLocation"),document.getElementById("showScore").innerHTML="Score "+e+"/10",document.getElementById("resultsScreen").style.webkitTransform="translate(0vw,0)";var n=document.getElementById("question"+numberOfPages);n.classList.remove("activePage"),n.classList.add("previousPage"),document.getElementById("submitResultsFormButton").addEventListener("click",submitResults)}function submitResults(){localStorage.setItem("name",document.getElementById("resultsName").value),localStorage.setItem("email",document.getElementById("resultsEmail").value),resetQuiz(1)}function resetQuiz(e){document.getElementById("showScore").innerHTML="",document.getElementById("resultsScreen").style.webkitTransform="translate(100vw,0)",document.getElementById("pageLocation").classList.remove("hiddenPageLocation");for(var t=0;numberOfPages>t;t++){score[t]=0;var n=t+1;document.getElementById(n).value="";var a=document.getElementById("question"+n);a.classList.remove("previousPage"),a.style.transition="",a.style.webkitTransform=""}setUpSwipe(1,numberOfPages,"question")}function checkAnswer(e){e.srcElement.value==questionsInfo[e.srcElement.id-1].answer?score[e.srcElement.id-1]=1:score[e.srcElement.id-1]=0}function resultsPage(){return"<div id='resultsScreen'><h2>Results</h2><h3 id='showScore'></h3><div id='submitResultsForm'><label for='name' >Name: </label><input type='text' id='resultsName' name='name'/><br><label for='Email' >Email: </label><input type='Email' id='resultsEmail' name='Email'/><br><label for='colour' >Favourite Colour: </label><input type='color' id='colour' name='colour'/><br><input type='submit' name='submit' value='Submit Results' id='submitResultsFormButton' /></div></div>"}function setUpSwipe(e,t,n){currentPage=e,numberOfPages=t,sectionToListenTo=n,setPageActiveAndNextPage();for(var a=document.getElementsByClassName(sectionToListenTo),i=0;i<a.length;i++)a[i].addEventListener("touchstart",touchstart,!1);createPageCircles(t,e)}function createPageCircles(e,t){for(var n="",a=0;e>a;a++){var i=a+1,o="circle";i===t&&(o+=" selectedPageIndicator"),n+="<div class='"+o+"' id='page"+i+"'></div>"}document.getElementById("pageCircles").innerHTML=n}function setPageActiveAndNextPage(){for(var e=1;numberOfPages>=e;e++){var t=document.getElementById(sectionToListenTo+e);currentPage.toString()==e?t.classList.add("activePage"):currentPage.toString()>e?t.classList.add("previousPage"):currentPage.toString()<e&&t.classList.add("nextPage")}}function touchstart(e){var t=findRealTarget(e.target,sectionToListenTo);t.removeEventListener("touchstart",touchstart,!1),t.addEventListener("touchend",touchend,!1),t.addEventListener("touchmove",touchmove,!1);var n=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY;t.setAttribute("data-x",n),t.setAttribute("data-y",a)}function touchmove(e){var t=findRealTarget(e.target,sectionToListenTo),n=t.getAttribute("data-x"),a=t.getAttribute("data-y"),i=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,s=i-n,r=o-a;if(s*s>r*r){t.style.webkitTransform="translate("+s+"px,0px)";var l=window.matchMedia("(min-width: 700px)"),u=300;if(l.matches&&(u=700),nextPage=getNextPage(),null!=nextPage){var c=parseInt(s)+u;nextPage.style.webkitTransform="translate("+c.toString()+"px,0px)"}if(previousPage=getPreviousPage(),null!=previousPage){var m=parseInt(s)-u;previousPage.style.webkitTransform="translate("+m.toString()+"px,0px)"}e.preventDefault()}else touchend(e)}function touchend(e){var t=findRealTarget(e.target,sectionToListenTo),n=t.getAttribute("data-x"),a=(t.getAttribute("data-y"),e.changedTouches[0].clientX),i=(e.changedTouches[0].clientY,a-n);nextPage=getNextPage(),previousPage=getPreviousPage(),-150>i&&currentPage!=numberOfPages?(t.style.transition=transformText,t.style.webkitTransform="translate(-100vw,0)",nextPage.style.transition=transformText,nextPage.style.webkitTransform="translate(0vw,0)",movePagesAroundMoveLeft()):i>150&&1!=currentPage?(t.style.transition=transformText,t.style.webkitTransform="translate(100vw,0)",previousPage.style.transition=transformText,previousPage.style.webkitTransform="translate(0vw,0)",movePagesAroundMoveRight()):(t.style.transition=transformText,t.style.webkitTransform="",null!=nextPage&&(nextPage.style.transition=transformText,nextPage.style.webkitTransform=""),null!=previousPage&&(previousPage.style.transition=transformText,previousPage.style.webkitTransform="")),setTimeout(function(){t.style.transition="",t.style.webkitTransform="",null!=nextPage&&(nextPage.style.transition="",nextPage.style.webkitTransform=""),null!=previousPage&&(previousPage.style.transition="",previousPage.style.webkitTransform=""),t.addEventListener("touchstart",touchstart,!1),t.removeEventListener("touchend",touchend,!1),t.removeEventListener("touchmove",touchmove,!1)},500)}function movePagesAroundMoveLeft(){var e=document.getElementById(sectionToListenTo+currentPage.toString());e.classList.add("previousPage"),e.classList.remove("activePage"),document.getElementById("page"+currentPage.toString()).classList.remove("selectedPageIndicator"),currentPage++;var t=document.getElementById(sectionToListenTo+currentPage.toString());t.classList.add("activePage"),t.classList.remove("nextPage"),document.getElementById("page"+currentPage.toString()).classList.add("selectedPageIndicator")}function movePagesAroundMoveRight(){var e=document.getElementById(sectionToListenTo+currentPage.toString());e.classList.add("nextPage"),e.classList.remove("activePage"),document.getElementById("page"+currentPage.toString()).classList.remove("selectedPageIndicator"),currentPage--;var t=document.getElementById(sectionToListenTo+currentPage.toString());t.classList.add("activePage"),t.classList.remove("previousPage"),document.getElementById("page"+currentPage.toString()).classList.add("selectedPageIndicator")}function findRealTarget(e,t){return e.classList.contains(t)?e:null==e.parentElement?!1:findRealTarget(e.parentElement,t)}function getNextPage(){if(currentPage!=numberOfPages){var e=currentPage+1,t=document.getElementById(sectionToListenTo+e.toString());return t}return null}function getPreviousPage(){if(1!=currentPage){var e=currentPage-1,t=document.getElementById(sectionToListenTo+e.toString());return t}return null}var planetLinks="",backButton="",pages="",questionsInfo="",score=[],mainPagesInApp=["homePage","informationPage","quizPage"],currentPage=0,numberOfPages=0,sectionToListenTo="",transformText="-webkit-transform .3s linear",map;loadPlanetList(),makeRequest("SpaceQuestion.txt","setQuestions","quizQuestions");for(var mainNav=document.getElementsByClassName("mainNav"),i=0;i<mainNav.length;i++)mainNav[i].addEventListener("click",mainNavigation,!1);window.addEventListener("popstate",historyPop,!1),setTimeout(function(){setActivePage();var e=document.getElementById("mainFooter");e.style.transition="transform .3s linear",e.style.transform="translate(0vw,0)",e.style.transition="-webkit-transform .3s linear",e.style.webkitTransform="translate(0vw,0)";var t=document.getElementById("splashScreen");t.classList.add("inactive")},500);
